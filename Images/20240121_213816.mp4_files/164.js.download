(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[164],{867:function(e,t,n){"use strict";n.d(t,"u",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"s",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"l",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"m",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"o",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"d",function(){return h}),n.d(t,"p",function(){return b}),n.d(t,"n",function(){return g});var a=n(143);function i(){return a.b.isActivated("dd3dba4e-4baa-4bd3-95bf-64ffae9b7b51")}function r(){return a.b.isActivated("a4a3d2f4-ad0e-4684-adee-a5ceec193558")}function o(){return a.b.isActivated("e212149a-997e-4aa9-aa89-8be796153d3e")}function s(){return a.b.isActivated("ca6e64a5-3cde-4350-8a45-a21de378cc60")}function c(){return a.b.isActivated("e0bd3586-89a3-466b-8ee0-db1f9457fe99")}function d(){return a.b.isActivated("1a423106-78a1-4238-ba44-dd5f7f4138df")}function l(){return a.b.isActivated("fed6018f-7453-47fc-aecb-2d9505b62bb4")}function u(){return a.b.isActivated("733da2bd-f34d-4979-8c7b-df7342291267")}function f(){return a.b.isActivated("043feae9-5a56-40ff-b175-6f7f813507ff")}function p(){return a.b.isActivated("5a350491-8d32-46a3-a4c4-fdce19a5f73e")}function m(){return a.b.isActivated("e6246a29-f6af-41de-88b7-3f023102181b")}function _(){return a.b.isActivated("7fb9acc4-19f2-446f-b592-f15c49bfd771")}function h(){return a.b.isActivated("acdd82b0-5d29-4a05-9d39-af32437292c5")}function b(){return a.b.isActivated("43551625-af3d-44b0-8fb3-f0272435c606")}function g(){return a.b.isActivated("db350345-b6f8-4c00-9cbe-49ae316f6637")}},1462:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"r",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"o",function(){return u}),n.d(t,"s",function(){return f});var a=n(143);function i(){return a.h.isEnabled(60346)}function r(){return a.h.isEnabled(61223)}function o(){return a.h.isEnabled(1365)}function s(){return a.h.isEnabled(1512)}function c(){return a.h.isEnabled(1791)}function d(){return a.h.isEnabled(60835)}function l(){return a.h.isEnabled(60244)}function u(){return a.h.isEnabled(687)}function f(){return a.h.isEnabled(61291)}},2239:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.BEARER="Bearer",e.POP="pop"}(a||(a={}))},3013:function(e,t,n){"use strict";n.r(t),n.d(t,"DeferredAadTokenProvider",function(){return f});var a=n(2),i=n(143),r=n(476),o=n(1204),s=n(613),c=n(1462),d=n(867),l=n(2239),u=function(e){function t(t,n){var a=e.call(this,t)||this;return a.code=n,a}return Object(a.__extends)(t,e),t}(Error),f=function(){function e(e,t,n,a,r,o,s){this._oboFirstPartyTokenCallback=o,this._oboThirdPartyTokenCallback=s,i.l.isNonemptyString(a.aadInstanceUrl,"aadInstanceUrl"),i.l.isNonemptyString(a.aadTenantId,"aadTenantId"),i.l.isNonemptyString(a.redirectUri,"redirectUri"),i.l.isNonemptyString(a.servicePrincipalId,"servicePrincipalId"),this._defaultConfiguration=a,this._oboConfiguration=r,this._tokenAcquisitionEvent=e,this.onBeforeRedirectEvent=t,this.popupEvent=n,this._failedTokenRequests=new Map}return e.prototype.getToken=function(e,t){void 0===t&&(t=!0);var n=t&&"object"==typeof t?t:{useCachedToken:t,authenticationScheme:l.e.BEARER};return this._defaultConfiguration.servicePrincipalId===i.e.empty.toString()?Promise.reject(new Error(o.t)):this._getTokenInternal(e,this._defaultConfiguration,n)},e.prototype._getTokenData=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var a=t&&"object"==typeof t?t:{useCachedToken:t,skipLoggingAndDisableRedirects:n,claims:void 0,authenticationScheme:l.e.BEARER};if(this._defaultConfiguration.servicePrincipalId===i.e.empty.toString())return Promise.reject(new Error(o.t));if(this._shouldUseMsalBrowserTokenProvider(this._defaultConfiguration))return this._getMsalBrowserTokenProvider(this._defaultConfiguration).then(function(t){return t.getTokenData(e,a)});if(this._shouldUseMsalTokenProvider(this._defaultConfiguration))return this._getMsalTokenProvider(this._defaultConfiguration).then(function(t){return t.getTokenData(e,a)});throw new Error("Getting token response not supported for the current token provider")},e.prototype._getTokenInternal=function(e,t,n){var a=this;void 0===n&&(n=!0);var i,o=n&&"object"==typeof n?n:{useCachedToken:n,authenticationScheme:l.e.BEARER},c=new r.n("AadTokenProvider.GetAppTokenTimePerf");if(!this._shouldTokenBeRequested(e))throw c.writeExpectedFailure("Token already requested and failed"),Object(d.a)()?Error("Token request previously failed"):new u("Token request previously failed","TokenRequestPreviouslyFailed");var f=t||this._defaultConfiguration;if(this._shouldUseOboTokenExchange(f)&&this._oboConfiguration)i=this._getOboTokenProvider(f,this._oboConfiguration,this._oboFirstPartyTokenCallback,this._oboThirdPartyTokenCallback).then(function(t){return a._getToken(t,e,o)});else if(this._shouldUseMsalBrowserV3TokenProvider(f))i=this._getMsalBrowserV3TokenProvider(f).then(function(t){return a._getToken(t,e,o)});else{if(this._shouldUseMsalBrowserTokenProvider(f))return this._getMsalBrowserTokenProvider(f).then(function(t){return a._getToken(t,e,o)});i=this._shouldUseMsalTokenProvider(f)?this._getMsalTokenProvider(f).then(function(t){return a._getToken(t,e,o)}):this._getImplicitTokenProvider(f).then(function(t){return a._getToken(t,e,o)})}return i.then(function(t){var n=f.servicePrincipalId===s.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID,a={isInternal:n};return n&&(a.name=e),c.writeSuccess(a),t}).catch(function(t){throw Object(d.e)()?c.writeUnexpectedFailure():c.writeUnexpectedFailure(void 0,t),a._addFailedRequest(e),t})},e.prototype._ensureState=function(){this._shouldEnsureRefreshToken()&&this._getMsalBrowserV3TokenProvider(this._defaultConfiguration).then(function(e){e._ensureState()})},e.prototype._shouldEnsureRefreshToken=function(){return!(Object(d.n)()||!this._shouldUseMsalBrowserV3TokenProvider(this._defaultConfiguration)||"true"===window.sessionStorage.getItem("_isRunningTABTest")||i.p.isTeamsHosted()||i.p.isWebViewHosted())},e.prototype._addFailedRequest=function(e){Object(d.u)()||this._failedTokenRequests.set(e,new Date(Date.now()))},e.prototype._shouldTokenBeRequested=function(e){if(!Object(d.u)()){var t=this._failedTokenRequests.get(e);if(t)return Date.now()-t.getTime()>3e5}return!0},e.prototype._getToken=function(e,t,n){return e.getToken(t,n)},Object.defineProperty(e.prototype,"tokenAcquisitionEvent",{get:function(){return this._tokenAcquisitionEvent},enumerable:!1,configurable:!0}),e.prototype._shouldUseMsalTokenProvider=function(e){var t=!!i.e.tryParse(e.aadSessionId),n=t||""===e.aadSessionId;if(!t){var a=new r.n("DeferredAadTokenProvider._shouldUseMsalTokenProvider"),o={aadSessionId:e.aadSessionId};n&&(e.aadSessionId=""),a.writeUnexpectedFailure("isAadSessionIdValidGuid",void 0,o)}return n},e.prototype._shouldUseMsalBrowserTokenProvider=function(e){return!!(Object(c.n)()||e.enableClaimChallenges||e.enableMetaOS)&&this._isFirstParty(e.servicePrincipalId)},e.prototype._shouldUseMsalBrowserV3TokenProvider=function(e){if(Object(c.a)()){var t=!!this._defaultConfiguration.thirdPartyReplyUrisUpdated&&this._defaultConfiguration.thirdPartyReplyUrisUpdated;return this._isFirstParty(e.servicePrincipalId)||t}return!1},e.prototype._getAdalAuthContextManager=function(e){return this._authContextManager||(this._authContextManager=n.ee([165],3614).then(function(e){return new e.AdalAuthContextManager})),this._authContextManager},e.prototype._getMsalTokenProvider=function(e){var t=this;return Object(c.c)()?n.ee([484],3173).then(function(n){return t._isFirstParty(e.servicePrincipalId)?(t._firstPartyMsalTokenProvider||(t._firstPartyMsalTokenProvider=new n.MsalTokenProvider(e)),t._firstPartyMsalTokenProvider):(t._thirdPartyMsalTokenProvider||(t._thirdPartyMsalTokenProvider=new n.MsalTokenProvider(e)),t._thirdPartyMsalTokenProvider)}):n.ee([485],3174).then(function(n){return t._isFirstParty(e.servicePrincipalId)?(t._firstPartyMsalTokenProvider||(t._firstPartyMsalTokenProvider=new n.MsalTokenProvider(e)),t._firstPartyMsalTokenProvider):(t._thirdPartyMsalTokenProvider||(t._thirdPartyMsalTokenProvider=new n.MsalTokenProvider(e)),t._thirdPartyMsalTokenProvider)})},e.prototype._getMsalBrowserV3TokenProvider=function(e){var t=this;return n.ee(22,3622).then(function(n){return t._isFirstParty(e.servicePrincipalId)?(t._firstPartyMsalBrowserTokenProvider||(t._firstPartyMsalBrowserTokenProvider=new n.MsalBrowserTokenProvider(e)),t._firstPartyMsalBrowserTokenProvider):(t._thirdPartyMsalBrowserTokenProvider||(t._thirdPartyMsalBrowserTokenProvider=new n.MsalBrowserTokenProvider(e)),t._thirdPartyMsalBrowserTokenProvider)})},e.prototype._getMsalBrowserTokenProvider=function(e){var t=this;return Object(c.t)()||e.enableMetaOS?n.ee(22,3634).then(function(n){return t._firstPartyMsalBrowserTokenProvider||(t._firstPartyMsalBrowserTokenProvider=new n.MsalBrowserTokenProvider(e)),t._firstPartyMsalBrowserTokenProvider}):n.ee([483],3606).then(function(n){return t._firstPartyMsalBrowserTokenProvider||(t._firstPartyMsalBrowserTokenProvider=new n.MsalBrowserTokenProvider(e)),t._firstPartyMsalBrowserTokenProvider})},e.prototype._getImplicitTokenProvider=function(e){var t=this;return n.ee([640],3643).then(function(n){return t._isFirstParty(e.servicePrincipalId)?(t._firstPartyImplicitTokenProvider||(t._firstPartyImplicitTokenProvider=new n.ImplicitFlowTokenProvider(e)),t._firstPartyImplicitTokenProvider):(t._thirdPartyImplicitTokenProvider||(t._thirdPartyImplicitTokenProvider=new n.ImplicitFlowTokenProvider(e)),t._thirdPartyImplicitTokenProvider)})},e.prototype._getOboTokenProvider=function(e,t,n,a){var i=this;return this._getAdalAuthContextManager(e).then(function(r){return i._isFirstParty(e.servicePrincipalId)?(i._firstPartyOboTokenProvider||(i._firstPartyOboTokenProvider=r.getOboTokenProvider(e,t,n,a)),i._firstPartyOboTokenProvider):(i._thirdPartyOboTokenProvider||(i._thirdPartyOboTokenProvider=r.getOboTokenProvider(e,t,n,a)),i._thirdPartyOboTokenProvider)})},e.prototype._isFirstParty=function(e){return e===s.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID||e===s.e.ODC_AAD_APP_PRINCIPAL_ID||!Object(d.p)()&&e===s.e.SPO_FIRST_PARTY_APP_HELPER_ID},e.prototype._isInIsolatedDomain=function(){var e=window.location.hostname.split(".")[0],t=e.lastIndexOf("-app"),n=!1;if(t>-1){var a=e.substring(t);a.length>32&&(n=!!i.e.tryParse(a.substring(a.length-32)))}return n},e.prototype._shouldUseOboTokenExchange=function(e){return Object(d.t)()?(Object(d.f)()||(Object(c.i)()&&i.p.isTeamsHosted()||!Object(d.m)()&&i.p.isUsingSecureBroker()?i.p.isTeamsHosted():i.p.isWebViewHosted())||Object(c.o)()&&/.*AppleWebKit.*Safari/.test(navigator.userAgent))&&!!this._oboConfiguration:!!this._oboConfiguration&&(Object(c.a)()&&!this._isFirstParty(e.servicePrincipalId)&&!i.p.isTeamsHosted()&&!this._isInIsolatedDomain()||(Object(c.i)()&&i.p.isTeamsHosted()||!Object(d.m)()&&i.p.isUsingSecureBroker()?i.p.isTeamsHosted():i.p.isWebViewHosted())||Object(c.o)()&&/.*AppleWebKit.*Safari/.test(navigator.userAgent))},e}()}}]);